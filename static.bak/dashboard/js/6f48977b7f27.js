(function(){"use strict";angular.module('horizon.framework.widgets.details').controller('RoutedDetailsViewController',controller);controller.$inject=['horizon.framework.conf.resource-type-registry.service','horizon.framework.util.actions.action-result.service','horizon.framework.widgets.modal-wait-spinner.service','$q','$routeParams','$rootScope'];function controller(registry,resultService,spinnerService,$q,$routeParams,$rootScope){var ctrl=this;ctrl.resourceType=registry.getResourceType($routeParams.type);ctrl.context={};ctrl.context.identifier=ctrl.resourceType.parsePath($routeParams.path);ctrl.context.loadPromise=ctrl.resourceType.load(ctrl.context.identifier);ctrl.context.loadPromise.then(loadData);ctrl.defaultTemplateUrl=registry.getDefaultDetailsTemplateUrl();ctrl.resultHandler=actionResultHandler;function actionResultHandler(returnValue){return $q.when(returnValue,actionSuccessHandler);}
function loadData(response){spinnerService.hideModalSpinner();ctrl.showDetails=true;ctrl.resourceType.initActions($rootScope.$new());ctrl.itemData=response.data;ctrl.itemName=ctrl.resourceType.itemName(response.data);}
function actionSuccessHandler(result){if(result){spinnerService.showModalSpinner(gettext('Please Wait'));ctrl.showDetails=false;ctrl.context.loadPromise=ctrl.resourceType.load(ctrl.context.identifier);ctrl.context.loadPromise.then(loadData);}}}})();