(function(){'use strict';angular.module('horizon.app.core.images').factory('horizon.app.core.images.actions.update-metadata.service',updateMetadataService);updateMetadataService.$inject=['$q','horizon.app.core.metadata.modal.service','horizon.app.core.openstack-service-api.policy','horizon.framework.util.actions.action-result.service','horizon.framework.util.q.extensions','horizon.app.core.images.resourceType'];function updateMetadataService($q,metadataModalService,policy,actionResultService,$qExtensions,imageResourceType){var service={perform:perform,allowed:allowed};return service;function perform(image){return metadataModalService.open('image',image.id).result.then(onSuccess);function onSuccess(){return actionResultService.getActionResult().updated(imageResourceType,image.id).result;}}
function allowed(image){return $q.all([policy.ifAllowed({rules:[['image','modify_metadef_object']]}),isActive(image)]);}
function isActive(image){return $qExtensions.booleanAsPromise(image.status==='active');}}})();