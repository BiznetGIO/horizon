(function(){'use strict';angular.module('horizon.framework.widgets.table').controller('TableController',TableController);TableController.$inject=['$scope','horizon.framework.widgets.table.events'];function TableController($scope,events){var ctrl=this;ctrl.trackId='id';ctrl.isSelected=isSelected;ctrl.toggleSelect=toggleSelect;ctrl.broadcastExpansion=broadcastExpansion;clearSelected();var clearWatcher=$scope.$on(events.CLEAR_SELECTIONS,clearSelected);$scope.$on('$destroy',function(){clearWatcher();});function isSelected(row){var rowState=ctrl.selections[row[ctrl.trackId]];return angular.isDefined(rowState)&&rowState.checked;}
function clearSelected(){ctrl.selected=[];ctrl.selections={};}
function getSelected(map){return Object.keys(map).filter(function isChecked(k){return map[k].checked;}).map(function getItem(k){return map[k].item;});}
function toggleSelect(row,checkedState,broadcast){var key=row[ctrl.trackId];ctrl.selections[key]={checked:checkedState,item:row};ctrl.selected=getSelected(ctrl.selections);if(broadcast){var rowObj={row:row,checkedState:checkedState};$scope.$broadcast(events.ROW_SELECTED,rowObj);}}
function broadcastExpansion(item){$scope.$broadcast(events.ROW_EXPANDED,item);}}})();